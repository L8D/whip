<!DOCTYPE html>

<html>
<head>
  <title>corelib.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="bin.html">
                bin.js
              </a>
            
              
              <a class="source" href="corelib.html">
                corelib.coffee
              </a>
            
              
              <a class="source" href="stdlib.html">
                stdlib.coffee
              </a>
            
              
              <a class="source" href="syn.html">
                syn.coffee
              </a>
            
              
              <a class="source" href="whip.html">
                whip.coffee
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>corelib.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>whip = require <span class="string">'./whip'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h1>CoreLib Function Stack</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>fns =</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h3>Lambda</h3>
<p>The corelib lambda function takes 1-2 arguements.
If it gets 2 arguments, it will return a function(<em>lambda</em>) that will
bind the list of raw identifiers(in the first argument) to the arguments
given of that lambda(inside the return arg&#39;s scope). Otherwise, if there is one argument,
then it will skip the binding process.</p>
<p>The resulting code looks like this:</p>
<pre><code>(lambda (x) (+ x 10))</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  lambda: (input, context) -&gt;
    (lambda_args) -&gt;
      <span class="keyword">unless</span> input.length <span class="keyword">is</span> <span class="number">2</span>
        lambda_scope = input[<span class="number">1</span>].reduce (acc, x, i) -&gt;
          acc[x.value] = lambda_args[i]
          acc
        , {}
      <span class="keyword">else</span>
        lambda_scope = {}

      whip.interpret input[input.length - <span class="number">1</span>], <span class="keyword">new</span> whip.Context(lambda_scope, context)</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h3>Let</h3>
<p>The corelib let function takes two arguments.
The first is a list of lists of [raw_ident, value] syntax.
The second is a return value which will have a modified scope for the arguments.</p>
<p>I&#39;m not sure why I kept it, but the resulting code looks like:</p>
<pre><code>(let ((x 10) (y 5)) (+ x y)) ; = 10 + 5 =&gt; 15</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="reserved">let</span>: (input, context) -&gt;
    let_context = input[<span class="number">1</span>].reduce (acc, x) -&gt;
      acc.scope[x[<span class="number">0</span>].value] = whip.interpret x[<span class="number">1</span>], context
      acc
    , <span class="keyword">new</span> whip.Context({}, context)

    whip.interpret input[<span class="number">2</span>], let_context</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h3>Def</h3>
<p>The def function is a much more usable version of <code>let</code>.
It takes two args, an ident and a value.
It then uses the <code>Context::set</code> method for setting the value
(the second arg) to the global namespace.</p>
<p>This allows for your code to be maintained in the same context,
at the same indent, and allow future code or libraries to use it.</p>
<p>Looks like:</p>
<pre><code>(def x 10)
(x) ; =&gt; 10</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  def: (input, context) -&gt;
    v = whip.interpret input[<span class="number">2</span>]
    context.set input[<span class="number">1</span>].value, v
    v

module.exports = fns</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Lambda shortcut of <code>-&gt;</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>module.exports[<span class="string">'-&gt;'</span>] = fns.lambda</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
